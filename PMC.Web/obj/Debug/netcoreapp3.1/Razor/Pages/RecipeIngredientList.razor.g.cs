#pragma checksum "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "a0b0e021aeffe2e85db76161c9e8039dc36b85cb"
// <auto-generated/>
#pragma warning disable 1591
namespace PMC.Web.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Users\Debora\source\repos\PMC\PMC.Web\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\Debora\source\repos\PMC\PMC.Web\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\Debora\source\repos\PMC\PMC.Web\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\Debora\source\repos\PMC\PMC.Web\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\Debora\source\repos\PMC\PMC.Web\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\Debora\source\repos\PMC\PMC.Web\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\Debora\source\repos\PMC\PMC.Web\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\Debora\source\repos\PMC\PMC.Web\_Imports.razor"
using PMC.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\Debora\source\repos\PMC\PMC.Web\_Imports.razor"
using PMC.Web.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
using PMC.Data;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
using PMC.DataModel;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
using PMC.Web.Data;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/recipeingredientlist")]
    public partial class RecipeIngredientList : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
#nullable restore
#line 13 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
 if (SelectedIngredientService.IngredientCount == 0)
{

#line default
#line hidden
#nullable disable
            __builder.AddContent(0, "    ");
            __builder.AddMarkupContent(1, "<p>This recipe does not contain any ingredients</p>\r\n");
#nullable restore
#line 16 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
}

#line default
#line hidden
#nullable disable
            __builder.AddMarkupContent(2, "\r\n");
#nullable restore
#line 18 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
 if (SelectedIngredientService.IngredientCount > 0)
{

#line default
#line hidden
#nullable disable
            __builder.AddContent(3, "    ");
            __builder.OpenElement(4, "div");
            __builder.AddAttribute(5, "width", "500px");
            __builder.AddMarkupContent(6, "\r\n        ");
            __builder.OpenElement(7, "table");
            __builder.AddAttribute(8, "style", "overflow-x: auto;");
            __builder.AddMarkupContent(9, "\r\n            ");
            __builder.AddMarkupContent(10, @"<tr>
                <th style=""background-color:lightgray; text-align:center""><b>Qty</b></th>
                <th style=""background-color:lightgray;""><b>UoM</b></th>
                <th style=""background-color:lightgray;""><b>Ingredient</b></th>
                <th style=""background-color:lightgray; text-align:center""><b>Delete</b></th>
            </tr>
");
#nullable restore
#line 28 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
             foreach (var list in ingredients)
            {
                decimal currentQty = list.IngredientQty;
                int currentUOM = list._riUOMID;

#line default
#line hidden
#nullable disable
            __builder.AddContent(11, "                ");
            __builder.OpenElement(12, "tr");
            __builder.AddMarkupContent(13, "\r\n                    ");
            __builder.OpenElement(14, "td");
            __builder.AddAttribute(15, "align", "center");
            __builder.AddAttribute(16, "valign", "top");
            __builder.AddMarkupContent(17, "\r\n                        ");
            __builder.OpenElement(18, "input");
            __builder.AddAttribute(19, "name", "numQty");
            __builder.AddAttribute(20, "type", "number");
            __builder.AddAttribute(21, "style", "width:60px; border-width: 0; background-color: rgb(233, 238, 252); vertical-align:top");
            __builder.AddAttribute(22, "min", ".01");
            __builder.AddAttribute(23, "max", "20000");
            __builder.AddAttribute(24, "onblur", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.FocusEventArgs>(this, 
#nullable restore
#line 36 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
                                          () => { newIngredientQty = currentQty; SelectedIngredientService.IngredientID = list._riIngredientID; StateHasChanged(); setIngredientQty(); }

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(25, "value", Microsoft.AspNetCore.Components.BindConverter.FormatValue(
#nullable restore
#line 35 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
                                       currentQty

#line default
#line hidden
#nullable disable
            , culture: global::System.Globalization.CultureInfo.InvariantCulture));
            __builder.AddAttribute(26, "onchange", Microsoft.AspNetCore.Components.EventCallback.Factory.CreateBinder(this, __value => currentQty = __value, currentQty, culture: global::System.Globalization.CultureInfo.InvariantCulture));
            __builder.SetUpdatesAttributeName("value");
            __builder.CloseElement();
            __builder.AddMarkupContent(27, "\r\n                    ");
            __builder.CloseElement();
            __builder.AddMarkupContent(28, "\r\n                    ");
            __builder.OpenElement(29, "td");
            __builder.AddAttribute(30, "valign", "top");
            __builder.AddMarkupContent(31, "\r\n                        ");
            __builder.AddContent(32, 
#nullable restore
#line 39 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
                         list.UomDesc

#line default
#line hidden
#nullable disable
            );
            __builder.AddMarkupContent(33, "\r\n                    ");
            __builder.CloseElement();
            __builder.AddMarkupContent(34, "\r\n                    ");
            __builder.OpenElement(35, "td");
            __builder.AddAttribute(36, "style", "position:relative");
            __builder.AddAttribute(37, "valign", "top");
            __builder.AddContent(38, 
#nullable restore
#line 41 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
                                                                list.IngredientName

#line default
#line hidden
#nullable disable
            );
            __builder.AddContent(39, " ");
            __builder.AddContent(40, 
#nullable restore
#line 41 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
                                                                                     list.IngredientCondition

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(41, "\r\n                    ");
            __builder.OpenElement(42, "td");
            __builder.AddAttribute(43, "align", "center");
            __builder.AddAttribute(44, "valign", "top");
            __builder.AddMarkupContent(45, "\r\n                        ");
            __builder.OpenElement(46, "label");
            __builder.AddMarkupContent(47, "\r\n                            ");
            __builder.OpenElement(48, "input");
            __builder.AddAttribute(49, "name", "choiceIngredientID");
            __builder.AddAttribute(50, "type", "radio");
            __builder.AddAttribute(51, "tabindex", "-1");
            __builder.AddAttribute(52, "value", 
#nullable restore
#line 45 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
                                           list._riIngredientID

#line default
#line hidden
#nullable disable
            );
            __builder.AddAttribute(53, "onchange", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.ChangeEventArgs>(this, 
#nullable restore
#line 46 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
                                                () => { SelectedIngredientService.IngredientID = list._riIngredientID; }

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(54, "oninput", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.ChangeEventArgs>(this, 
#nullable restore
#line 47 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
                                              AskDeleteIngredient

#line default
#line hidden
#nullable disable
            ));
            __builder.CloseElement();
            __builder.AddMarkupContent(55, "\r\n                        ");
            __builder.CloseElement();
            __builder.AddMarkupContent(56, "\r\n                    ");
            __builder.CloseElement();
            __builder.AddMarkupContent(57, "\r\n                ");
            __builder.CloseElement();
            __builder.AddMarkupContent(58, "\r\n");
#nullable restore
#line 51 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
            }

#line default
#line hidden
#nullable disable
            __builder.AddContent(59, "        ");
            __builder.CloseElement();
            __builder.AddMarkupContent(60, "\r\n    ");
            __builder.CloseElement();
            __builder.AddMarkupContent(61, "\r\n    <br>\r\n");
#nullable restore
#line 55 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"

}

#line default
#line hidden
#nullable disable
#nullable restore
#line 57 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
 if (errmsg.Length > 0)
{

#line default
#line hidden
#nullable disable
            __builder.AddContent(62, "    ");
            __builder.OpenElement(63, "div");
            __builder.AddAttribute(64, "style", "width:20px; word-wrap:break-word; background-color:lightpink; text-align:center");
            __builder.AddContent(65, 
#nullable restore
#line 59 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
                                                                                                  errmsg

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(66, "\r\n");
#nullable restore
#line 60 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
}

#line default
#line hidden
#nullable disable
            __builder.AddMarkupContent(67, "\r\n\r\n");
#nullable restore
#line 63 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
 if (yesDelete == true)
{

#line default
#line hidden
#nullable disable
            __builder.AddContent(68, "    ");
            __builder.OpenElement(69, "div");
            __builder.AddAttribute(70, "align", "right");
            __builder.AddMarkupContent(71, "\r\n        ");
            __builder.OpenElement(72, "div");
            __builder.AddAttribute(73, "align", "left");
            __builder.AddMarkupContent(74, "\r\n            ");
            __builder.OpenComponent<PMC.Web.Pages.BlazorModal>(75);
            __builder.AddAttribute(76, "Title", "Delete Ingredient");
            __builder.AddAttribute(77, "IsOpened", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#nullable restore
#line 67 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
                                                             isOpened

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(78, "ModalBody", (Microsoft.AspNetCore.Components.RenderFragment)((__builder2) => {
                __builder2.AddMarkupContent(79, "\r\n                    ");
                __builder2.AddMarkupContent(80, "<div>Are you sure you would like to delete this ingredient?</div>\r\n                    ");
                __builder2.AddMarkupContent(81, "<div style=\"padding-left:10px\">If yes, click the <b>Delete Ingredient</b> button.</div>\r\n                    ");
                __builder2.AddMarkupContent(82, "<div style=\"padding-left:10px\">If no, click <b>Close</b>.</div>\r\n                ");
            }
            ));
            __builder.AddAttribute(83, "ModalFooter", (Microsoft.AspNetCore.Components.RenderFragment)((__builder2) => {
                __builder2.AddMarkupContent(84, "\r\n                    ");
                __builder2.OpenElement(85, "div");
                __builder2.AddAttribute(86, "style", "text-align:center");
                __builder2.OpenElement(87, "input");
                __builder2.AddAttribute(88, "type", "button");
                __builder2.AddAttribute(89, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 74 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
                                                                                   DeleteIngredient

#line default
#line hidden
#nullable disable
                ));
                __builder2.AddAttribute(90, "value", "Delete Ingredient");
                __builder2.AddAttribute(91, "style", "background-color:yellow");
                __builder2.CloseElement();
                __builder2.AddContent(92, "    ");
                __builder2.OpenElement(93, "input");
                __builder2.AddAttribute(94, "type", "button");
                __builder2.AddAttribute(95, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 74 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
                                                                                                                                                                                                    DoNotDeleteIngredient

#line default
#line hidden
#nullable disable
                ));
                __builder2.AddAttribute(96, "value", "Do Not Delete Ingredient");
                __builder2.CloseElement();
                __builder2.CloseElement();
                __builder2.AddMarkupContent(97, "\r\n                ");
            }
            ));
            __builder.CloseComponent();
            __builder.AddMarkupContent(98, "\r\n        ");
            __builder.CloseElement();
            __builder.AddMarkupContent(99, "\r\n    ");
            __builder.CloseElement();
            __builder.AddMarkupContent(100, "\r\n");
#nullable restore
#line 79 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
}

#line default
#line hidden
#nullable disable
        }
        #pragma warning restore 1998
#nullable restore
#line 82 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\RecipeIngredientList.razor"
       

    [Inject]
    private RepoFactory repoFactory { get; set; }
    private int userID;
    private Recipe recipe = new Recipe();
    //private int recipeIngredientCount = 0;
    private int initialIngredientCount = 0;
    //private int ingredientID;
    //private decimal ingredientQty;
    //private int uom;
    //private string ingrCondition;
    //private int testIngredientID;
    //private List<Ingredient> ingredients = new List<Ingredient>();
    private List<RecipeIngredient> ingredients = new List<RecipeIngredient>();
    private List<RecipeIngredientRepo> recipeIngredients = new List<RecipeIngredientRepo>();
    private List<Uom> uomList = new List<Uom>();
    //private bool ack = false;
    private bool yesDelete = false;
    protected bool isOpened = false;
    protected bool checkedRadio = false;
    protected bool ingredientDeleted = false;
    protected decimal newIngredientQty;
    protected int newUOM;
    private string errmsg = "";

#pragma warning disable 1998
    protected override async Task OnInitializedAsync()
    {
        userID = repoFactory.UserID;

        var repo = repoFactory.Get<PMC.Data.RecipeRepo>();

        var currRecipeIngredientRepo = repoFactory.Get<PMC.Data.RecipeIngredientRepo>();
        var newList = currRecipeIngredientRepo.GetIngredientsByRecipeID(SelectedRecipeService.RecipeID);
        ingredients = newList.ToList();
        var ingrList = currRecipeIngredientRepo.GetIngredientsByRecipeID(SelectedRecipeService.RecipeID);
        initialIngredientCount = ingrList.Count();
        SelectedIngredientService.IngredientCount = ingrList.Count();

        var uomRepo = repoFactory.Get<PMC.Data.UomRepo>();
        var uomlist = uomRepo.GetUomList().ToList();
        uomList = uomlist;

        ingredientDeleted = false;
        StateHasChanged();
    }
#pragma warning restore 1998

    private void getIngredients()
    {
        var currRecipeIngredientRepo = repoFactory.Get<PMC.Data.RecipeIngredientRepo>();
        var newList = currRecipeIngredientRepo.GetIngredientsByRecipeID(SelectedRecipeService.RecipeID);
        ingredients = newList.ToList();
        SelectedIngredientService.IngredientCount = recipeIngredients.Count();
    }

    protected void AskDeleteIngredient()
    {
        checkedRadio = true;
        OpenModal();
        yesDelete = true;
        StateHasChanged();
    }

    protected void DoNotDeleteIngredient()
    {
        checkedRadio = false;
        yesDelete = false;
        StateHasChanged();
        NavManager.NavigateTo(HomeURIService.HomeUri + "myrecipe");
    }

    protected void DeleteIngredient()
    {

        var repo = repoFactory.Get<PMC.Data.RecipeIngredientRepo>();
        repo.DeleteRecipeIngredientByRecipeIDIngredientIDUserID(SelectedRecipeService.RecipeID, SelectedIngredientService.IngredientID, userID);
        SelectedIngredientService.IngredientID = 0;
        ingredientDeleted = true;
        var ingrList = repo.GetIngredientsByRecipeID(SelectedRecipeService.RecipeID);
        ingredients = ingrList.ToList();
        SelectedIngredientService.IngredientCount = ingrList.Count();
        CloseModal();
        StateHasChanged();
    }

    //PMC1033-02
    private void setIngredientQty()
    {
        checkIngredientInfo();
        if (newIngredientQty <= 20000)
        {
            var repo = repoFactory.Get<PMC.Data.RecipeIngredientRepo>();
            var updateRecord = repo.SetRecipeIngredientQtyByRecipeID(SelectedRecipeService.RecipeID, SelectedIngredientService.IngredientID, newIngredientQty);
        }


        refreshPage();
    }

    //Although this method is here we are not providing the ability to modify the UOM
    //because I can't figure out how to select the current UOM to make it display in the drop down.
    private void setIngredientUOM()
    {
        var repo = repoFactory.Get<PMC.Data.RecipeIngredientRepo>();
        var updateRecord = repo.SetRecipeIngredientUOMByRecipeID(SelectedIngredientService.IngredientID, newUOM);

        refreshPage();
    }

    private void refreshPage()
    {
        SelectedIngredientService.IngredientID = 0;
        SelectedIngredientService.OnChange += StateHasChanged;
        StateHasChanged();
        NavManager.NavigateTo(HomeURIService.HomeUri + "empty");
        NavManager.NavigateTo(HomeURIService.HomeUri + "myrecipe");
    }

    private void checkIngredientInfo()
    {
        if (newIngredientQty > 20000)
        {
            errmsg = "The quantity cannot be greater than 20,001. Please update the quantity to a value less than 20,001.";
        }
    }


    void OpenModal()
    {
        isOpened = true;

    }
    void CloseModal()
    {
        isOpened = false;
    }


#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private HomeURIService HomeURIService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private NavigationManager NavManager { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private SelectedIngredientService SelectedIngredientService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private SelectedRecipeService SelectedRecipeService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IJSRuntime JSRuntime { get; set; }
    }
}
#pragma warning restore 1591
