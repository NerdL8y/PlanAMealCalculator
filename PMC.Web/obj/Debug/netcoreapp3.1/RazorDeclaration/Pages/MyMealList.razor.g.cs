// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace PMC.Web.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Users\Debora\source\repos\PMC\PMC.Web\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\Debora\source\repos\PMC\PMC.Web\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\Debora\source\repos\PMC\PMC.Web\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\Debora\source\repos\PMC\PMC.Web\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\Debora\source\repos\PMC\PMC.Web\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\Debora\source\repos\PMC\PMC.Web\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\Debora\source\repos\PMC\PMC.Web\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\Debora\source\repos\PMC\PMC.Web\_Imports.razor"
using PMC.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\Debora\source\repos\PMC\PMC.Web\_Imports.razor"
using PMC.Web.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\MyMealList.razor"
using PMC.Web.Data;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\MyMealList.razor"
using PMC.Data;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\MyMealList.razor"
using PMC.DataModel;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\MyMealList.razor"
using Microsoft.AspNetCore.WebUtilities;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/mymeallist")]
    public partial class MyMealList : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 64 "C:\Users\Debora\source\repos\PMC\PMC.Web\Pages\MyMealList.razor"
       
    [Inject]
    private RepoFactory repoFactory { get; set; }

    private int userID;
    private int mealID;
    protected int MealID { get { return mealID; } set { mealID = value; SelectedMealService.MealID = value; } }
    private int mealCount = 0;
    private int mealTypeCount = 0;
    private int totalDisplayRows;
    private string currentUri;
    private List<Meal> mealBreakfast = new List<Meal>();
    private List<Meal> mealBrunch = new List<Meal>();
    private List<Meal> mealLunch = new List<Meal>();
    private List<Meal> mealDinner = new List<Meal>();
    private List<Meal> mealTypes = new List<Meal>();
    private List<Meal> mealList = new List<Meal>();
    private int countBreakfast = 0;
    private int countBrunch = 0;
    private int countLunch = 0;
    private int countDinner = 0;
    private int breakfastMealType = 1;
    private int brunchMealType = 2;
    private int lunchMealType = 3;
    private int dinnerMealType = 4;

#pragma warning disable 1998
    protected override async Task OnInitializedAsync()
    {

        userID = repoFactory.UserID;

        //Get Meal Info
        var repo = repoFactory.Get<PMC.Data.MealRepo>();
        mealList = repo.GetMealsByUserID(userID).ToList();
        mealCount += mealList.Count();
        getMeals();
        //Get Meal Type info
        var mtrepo = repoFactory.Get<PMC.Data.MealRepo>();
        mealTypes = mtrepo.GetMealTypesForMealsByUserID(userID).ToList();
        mealTypeCount = mealTypes.Count();

        //total number of rows for displaying the meal list
        totalDisplayRows = mealCount + mealTypeCount + 1;

        //Reset the Selected Meal ID in case user clicks the Meal List link
        SelectedMealService.MealID = 0;
        //test stuff, may use in the future
        var uri = NavManager.ToAbsoluteUri(NavManager.Uri);
        if (QueryHelpers.ParseQuery(uri.Query).TryGetValue("mealID", out var _id))
        {
            mealID = Convert.ToInt32(_id);
        }
        var uri2 = NavManager.ToAbsoluteUri(NavManager.Uri);
        //NavigationManager.NavigateTo("/mymeal");
        currentUri = uri2.ToString();
    }
#pragma warning restore 1998

    private void getMeals()
    {
        var repo = repoFactory.Get<PMC.Data.MealRepo>();
        var typeOne = repo.GetMealsByMealTypeIDUserID(breakfastMealType, userID);
        mealBreakfast = typeOne.ToList();
        countBreakfast = mealBreakfast.Count() + 3;

        var typeTwo = repo.GetMealsByMealTypeIDUserID(brunchMealType, userID);
        mealBrunch = typeTwo.ToList();
        countBrunch = mealBrunch.Count() + 3;

        var typeThree = repo.GetMealsByMealTypeIDUserID(lunchMealType, userID);
        mealLunch = typeThree.ToList();
        countLunch = mealLunch.Count() + 3;

        var typeFour = repo.GetMealsByMealTypeIDUserID(dinnerMealType, userID);
        mealDinner = typeFour.ToList();
        countDinner = mealDinner.Count() + 3;
    }

    protected void mealSelect(ChangeEventArgs e)
    {
        isOpened = false;
        NavManager.NavigateTo(HomeURIService.HomeUri + "mymeal");
        StateHasChanged();
    }

    protected bool isOpened = false;
    void OpenModal()
    {
        isOpened = true;

    }
    void CloseModal()
    {
        isOpened = false;
    }



#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private HomeURIService HomeURIService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private SelectedMealService SelectedMealService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private NavigationManager NavManager { get; set; }
    }
}
#pragma warning restore 1591
